<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <style>
    html,
    body {
      padding: 0;
      margin: 0;
    }
    #cvs {
      display: block;
      width: 100%;
      height: 100%;
    }

    #fps {
      position: fixed;
      top: 10px;
      right: 10px;
      color: green;
    }
  </style>
  <body>
    <canvas id="cvs">瀏覽器如果不支援 canvas 元素，就顯示這行文字</canvas>
    <div id="fps">wait</div>
  </body>
  <script>
    const cvs = document.getElementById("cvs");
    const ctx = cvs.getContext("2d");
    const _fps = document.getElementById("fps");
    let flag = false;
    const then = Date.now();
    let fpsCount = 0;

    const run = () => {
      ctx.fillStyle = flag ? "black" : "blue";
      ctx.fillRect(0, 0, 300, 300);
      flag = !flag;
      fpsCount++;
      if (fpsCount % 20 === 0) {
        var time = (Date.now() - then) / fpsCount;
        var ms = Math.round(time * 1000) / 1000;
        var fps = Math.round(100000 / ms) / 100;
        _fps.textContent = `${fps} fps`;
      }
      requestAnimationFrame(run);
    };
    run();
  </script>
</html>
